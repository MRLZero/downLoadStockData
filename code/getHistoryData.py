# coding=utf-8
from getJPHistoryData import getJPHistoryData
from utils import *

if __name__ == '__main__':

    codes = [
        '1557', '1306', '1308', '1321', '1330', '1320', '1348', '1346', '1475', '1591', '1329', '1540', '1672', '1349',
        '1599', '1592', '1673', '1364', '1476', '1489', '1488', '2524', '1570', '1597', '1693', '1357', '1595', '2512',
        '1615', '1577', '2621', '1397', '2510', '1398', '1655', '1478', '2525', '2250', '2641', '2558', '1545', '1686',
        '2557', '1674', '2244', '1479', '2559', '1651', '2563', '1690', '2625', '1360', '2555', '2513', '1542', '2517',
        '1487', '1678', '2564', '2036', '1547', '2624', '2511', '1660', '2630', '1698', '2648', '2529', '2552', '2856',
        '2561', '1328', '2527', '1496', '1676', '2521', '2644', '1657', '2528', '1656', '1675', '2566', '2865', '2634',
        '1550', '1677', '2038', '1680', '2562', '2631', '2044', '1571', '2515', '2569', '2248', '2565', '1578', '1579',
        '1546', '1687', '1486', '2633', '1699', '1658', '1311', '1566', '1671', '2849', '2012', '1497', '2554', '2852',
        '2855', '1483', '1477', '1689', '1694', '236A', '1631', '2046', '2516', '1554', '2017', '2568', '2632', '2845',
        '1568', '1695', '1684', '1480', '1653', '1632', '2016', '1457', '235A', '200A', '2869', '2518', '2848', '2870',
        '2620', '1629', '1681', '2259', '1555', '2844', '2084', '2071', '1659', '234A', '1456', '1366', '2647', '2242',
        '2854', '2039', '2080', '2839', '2085', '2866', '2846', '1499', '2862', '2014', '2840', '210A', '1399', '2048',
        '2623', '2843', '1553', '1685', '2247', '183A', '2622', '1543', '1692', '1625', '2640', '2236', '1619', '2031',
        '2255', '2013', '1365', '2868', '1586', '2041', '201A', '2040', '2860', '1621', '2838', '1481', '2859', '1356',
        '2514', '1628', '1617', '233A', '181A', '1485', '2241', '1358', '2238', '2519', '2067', '2520', '1322', '2560',
        '1596', '1309', '2649', '2015', '2530', '1367', '2522', '2072', '238A', '159A', '1626', '237A', '1622', '2853',
        '2098', '1585', '2842', '2235', '1654', '1563', '1325', '188A', '1697', '1572', '2093', '1624', '2249', '1688',
        '2083', '1633', '2065', '2251', '2070', '2643', '213A', '2523', '1627', '2638', '2636', '2237'
    ]

    save_path = 'data/fundsHistoryValue'
    for code in codes:
        df = getJPHistoryData(code)
        df = process_qfq_value(df)
        saveFundHistoryValues(code, df, save_path)